---
minread: 8
draft: true
comments: true
title: "Big Integers: Multiplication"
description: "Devlog 2: Relearning second grade mathematics"
date: 2025-12-24T09:21:27-08:00
---

In the [last blog post](/blog/05), we discussed the internal representation of big integers, and basic addition and subtraction algorithms. In this post, I will discuss the wonderful world of [multiplication algorithms](https://en.wikipedia.org/wiki/Multiplication_algorithm) for big integers. This post will be fairly theory heavy, so buckle up and let's dive right in.

## Naive Method

Consider the [long multiplication](https://mathworld.wolfram.com/LongMultiplication.html)[^1] one learns in second grade. We will be using this as a starting point in multiplication algorithms. Let $a = 123$ and $b = 456$, and we will compute the quantity $c = a \cdot b$ using long multiplication:

$$
\large
\def\arraystretch{1.5}
\begin{array}{ccccc}
&& 1 & 2 & 3 \\\\
\times & & 4 & 5 & 6 \\\\ \hline
&& 7 & 3 & 8 \\\\
& 6 & 1 & 5 & \\\\
4 & 9 & 2 & & \\\\ \hline
5 & 6 & 0 & 8 & 8
\end{array}
$$

This algorithm works by multiplying each digit of $a$ with each digit of $b$ from right to left. Then, we shift the digits of each intermediate result to the left appropriately and add the results. In a more precise language, $c$ is calculated via iterating over all $a[i]$ and $b[j]$ and computing the quantity $c[i + j] = c[i + j] + a[i] \cdot b[j]$, then applying carries as appropriate. 

It is not difficult to see that this algorithm is $O(n^2)$, where $n$ is the number of digits of $a$ and $b$ (e.g. in the example above, both $a$ and $b$ are $3$ digits long, and the number of intermediate digits is $3 \cdot 3 = 9$). This is too slow for integers with many digits, such as those handled by big integer libraries. Thus, we must improve. 

## Fast Method

In 1960, Soviet mathematician [Andrey Kolmogorov](https://en.wikipedia.org/wiki/Andrey_Kolmogorov) hosted a seminar proposing that $O(n^2)$ was the optimal time complexity for multiplying two numbers of the same length. However, a 23-year-old student in the audience [Anatoly Karatsuba](https://en.wikipedia.org/wiki/Anatoly_Karatsuba) discovered [an algorithm](https://en.wikipedia.org/wiki/Karatsuba_algorithm) for multiplying two $n$-digit numbers in $O(n^{log_2{3}}) \approx O(n^{1.58})$ within a week afterwards. Then in the following years, [Andrew Toom](https://en.wikipedia.org/wiki/Andrei_Toom) and [Stephen Cook](https://en.wikipedia.org/wiki/Stephen_Cook) further [generalized this algorithm](https://en.wikipedia.org/wiki/Toom%E2%80%93Cook_multiplication). 

Python's big integer implementation uses Karatsuba multiplication. 

## Footnotes

[^1]: Sometimes also referred to as the "schoolbook multiplication", "grade-school multiplication", etc. 